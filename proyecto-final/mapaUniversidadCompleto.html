<!DOCTYPE html>
<html>
<head>
    <title>Mapa UAO</title>
    <meta charset="UTF-8">

    <style>
        /* Estilos para el cuerpo y el documento HTML */
        body, html {
            height: 100%; /* Establece la altura al 100% de la ventana del navegador */
            margin: 0; /* Elimina los márgenes alrededor del cuerpo y el documento HTML */
            padding: 0; /* Elimina el relleno (padding) alrededor del cuerpo y el documento HTML */
            background-color: orange; /* Establece el color de fondo a naranja */
        }

        /* INICIO DEL MENU DESPLEGABLE */
        /* Estilos para el ícono del menú */
        .menu-icon {
            position: absolute; /* Establece la posición absoluta en relación con el elemento primario */
            top: 10px; /* Establece la posición superior a 10 píxeles desde la parte superior del elemento primario */
            left: 10px; /* Establece la posición izquierda a 10 píxeles desde el borde izquierdo del elemento primario */
            z-index: 1000; /* Establece el orden de apilamiento del elemento */
            cursor: pointer; /* Cambia el cursor al puntero cuando se coloca sobre el elemento */
            padding: 10px; /* Establece un relleno de 10 píxeles alrededor del ícono */
        }

        .menu-icon span {
            display: block; /* Establece el elemento como bloque */
            width: 70px; /* Establece el ancho del elemento a 24 píxeles */
            height: 15px; /* Establece la altura del elemento a 2 píxeles */
            background-color: #000; /* Establece el color de fondo del elemento a negro */
            margin-bottom: 4px; /* Establece un margen inferior de 4 píxeles */
        }

        /* Estilos para el menú */
        .menu {
            position: fixed; /* Establece la posición fija en relación con la ventana del navegador */
            top: 0; /* Establece la posición superior a 0 píxeles desde la parte superior de la ventana del navegador */
            left: -100%; /* Cambia la posición inicial del menú fuera de la ventana del navegador */
            width: 70%; /* Cambia el ancho del menú al 100% de la ventana del navegador */
            height: 100%; /* Establece la altura del menú al 100% de la ventana del navegador */
            background-color: #fff; /* Establece el color de fondo del menú a blanco */
            transition: left 0.5s ease; /* Agrega una transición suave a la propiedad 'left' con una duración de 0.3 segundos y una aceleración suave */
        }

        .menu.open {
            left: 0; /* Muestra el menú desplazándolo hacia la izquierda hasta la posición 0 */
        }

        .menu ul {
            list-style-type: none; /* Elimina los estilos de lista predeterminados */
            padding: 0; /* Elimina el relleno (padding) alrededor de la lista */
            margin: 20px; /* Establece un margen de 20 píxeles alrededor de la lista */
        }

        .menu ul li {
            margin-bottom: 10px; /* Establece un margen inferior de 10 píxeles entre elementos de lista */
        }

        .menu ul li a {
            text-decoration: none; /* Elimina la decoración de subrayado del enlace */
            color: #000; /* Establece el color del texto a negro */
            font-weight: bold; /* Establece el peso de la fuente en negrita */
            font-size: 80px; /* Establece el tamaño de la fuente en 30 píxeles */
            font-family: 'Roboto', sans-serif;
        }

        /* FINAL DEL MENU DESPLEGABLE */

        /* estilo invisible */
        .invisible-char {
            opacity: 0;
        }
        /* Estilos para el contenedor del iframe */
        #map {
            position: relative; /* Cambia la posición a relativa para que los elementos internos se posicionen en relación con este contenedor */
            height: 90vh; /* Establece la altura al 90% de la ventana del navegador */
            width: 100vw; /* Establece el ancho al 100% de la ventana del navegador */
            margin: 5vh auto; /* Establece un margen superior e inferior de 5% y centrado horizontalmente */
            border: 12px solid black; /* Establece un borde de 12 píxeles de ancho y color negro */
            border-radius: 15px; /* Establece un radio de borde de 15 píxeles para crear esquinas redondeadas */
        }

        /* Estilos para el contenedor del iframe */

        #tourd {
            position: absolute; /* Cambia la posición a absoluta para que se pueda posicionar de manera precisa */
            bottom:-11vh;
            right: 36vw; /* Establece la posición derecha a 10 píxeles desde el borde derecho del contenedor padre */
            width: 60vw; /* Establece el ancho al 50% del contenedor padre */
            height: 60vh; /* Establece la altura al 50% del contenedor padre */
        }

        /* Estilos adicionales para hacer que el iframe sea responsivo */

        #tourd iframe {
            border: 0;
            width: 100%; /* Establece el ancho al 100% para que se ajuste al contenedor */
            height: 100%; /* Establece la altura al 100% para que se ajuste al contenedor */
        }
    </style>
</head>
<body>
<div >
    <div id="map"></div>
    <div id="tourd" >
        <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
    </div>
</div>
<!-- ICONO DEL MENU -->
<div class="menu-icon" onclick="toggleMenu()">
    <span></span>
    <span></span>
    <span></span>
</div>

<!-- PARTE DEL MENU CUANDO ESTA DESPLEGADO -->
<div class="menu">
    <ul>
        <li><a href="#"><span class="invisible-char">&#8203;</span></a></li>
        <li><a href="#">Opción 1</a></li>
        <li><a href="#">Opción 2</a></li>
        <li><a href="#">Opción 3</a></li>
        <li><a href="#">Opción 4</a></li>
    </ul>
</div>


<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
    // routes map lines
    let directionsRenderer;
    let polyline;

    //Funcion para que el menu desplegable funcione
    function toggleMenu() {
        var menu = document.querySelector('.menu');
        menu.classList.toggle('open');
    }

    /* ------------------------------------------------- */
    /* ----------------- map database ------------------ */
    /* ------------------------------------------------- */

    const UAOcoordenates = {lat: 16.9956106, lng: -96.7527389};

    const link_state = {
        coordinates: {}, // marker coordinates
        neighbors: [], // adjacency list
        constructor: function(coords, peer){
            this.coordinates = coords;
            this.neighbors = peer;
            return this;
        }
    }

    const map_database = {
        "engineering_parking_lot": Object.create(link_state).constructor(
            {lat: 16.996754, lng: -96.753210},
            ["E_building_inside"]
        ),
        "E_building_inside": Object.create(link_state).constructor(
            {lat: 16.996603, lng: -96.753191}, 
            ["engineering_parking_lot", "engineering_school", "design_school", "comunication_school", "posgrades_department", "E_building_entrance"]
        ),
        "engineering_school": Object.create(link_state).constructor(
            {lat: 16.996589, lng: -96.753296},
            ["E_building_inside"]
        ),
        "design_school": Object.create(link_state).constructor(
            {lat: 16.996616, lng: -96.753370},
            ["E_building_inside", "posgrades_department"]
        ),
        "comunication_school": Object.create(link_state).constructor(
            {lat: 16.996572, lng: -96.753146},
            ["E_building_inside"]
        ),
        "posgrades_department": Object.create(link_state).constructor(
            {lat: 16.997616, lng: -96.753081},
            ["E_building_inside", "design_school"]
        ),
        "E_building_entrance": Object.create(link_state).constructor(
            {lat: 16.996487, lng: -96.753185}, 
            ["E_building_inside", "E_building_lunch_zone", "west_path_E", "west_path_X"]
        ),
        "E_building_lunch_zone": Object.create(link_state).constructor(
            {lat: 16.996470, lng: -96.753323},
            ["E_building_entrance", "cuckoo_box", "west_path_X"]
        ),
        "cuckoo_box": Object.create(link_state).constructor(
            {lat: 16.996430, lng: -96.753480},
            ["E_building_lunch_zone", "dely_full"]
        ),
        "dely_full": Object.create(link_state).constructor(
            {lat: 16.996140, lng: -96.753429},
            ["cuckoo_box", "D_building_entrance", "library"]
        ),
        "C_building_entrance": Object.create(link_state).constructor(
            {lat: 16.996218, lng: -96.753051},
            ["west_path_C", "D_building_entrance", "C_building_inside"]
        ),
        "C_building_inside": Object.create(link_state).constructor(
            {lat: 16.996328, lng: -96.753051},
            ["C_building_entrance", "library", "court_room", "west_path_X"]
        ),
        "library": Object.create(link_state).constructor(
            {lat: 16.996325, lng: -96.753277},
            ["dely_full", "C_building_inside"]
        ),
        "court_room": Object.create(link_state).constructor(
            {lat: 16.996299, lng: -96.753152},
            ["C_building_inside"]
        ),
        "D_building_entrance": Object.create(link_state).constructor(
            {lat: 16.996133, lng: -96.753055},
            ["C_building_entrance", "dely_full", "D_building_inside"]
        ),
        "D_building_inside": Object.create(link_state).constructor(
            {lat: 16.996056, lng: -96.753071},
            ["D_building_entrance", "medicine_auditorium", "medicine_school"]
        ), // E building
        "medicine_school": Object.create(link_state).constructor(
            {lat: 16.996032, lng: -96.753318},
            ["D_building_inside"]
        ),
        "medicine_auditorium": Object.create(link_state).constructor(
            {lat: 16.995993, lng: -96.753152},
            ["D_building_inside"]
        ),
        "west_path_E": Object.create(link_state).constructor(
            {lat: 16.996482, lng: -96.753021},
            ["E_building_entrance", "west_path_X", "west_path_T", "west_path_C"]
        ), // C building
        "west_path_C": Object.create(link_state).constructor(
            {lat: 16.996218, lng: -96.752963},
            ["C_building_entrance", "west_path_T", "west_path_M", "west_path_E"]
        ), // irrelevant
        "west_path_X": Object.create(link_state).constructor(
            {lat: 16.996475, lng: -96.752860},
            ["west_path_E", "west_path_R", "west_path_M", "E_building_entrance", "E_building_lunch_zone"]
        ),  // T shaped
        "west_path_T": Object.create(link_state).constructor(
            {lat: 16.996348, lng: -96.752963},
            ["west_path_R", "west_path_C", "west_path_E"]
        ),  // central plaza
        "west_path_M": Object.create(link_state).constructor(
            {lat: 16.996211, lng: -96.752866},
            ["west_path_C", "west_path_R", "central_plaza_W", "west_path_X"]
        ), // roundabout
        "west_path_R": Object.create(link_state).constructor(
            {lat: 16.996350, lng: -96.752857},
            ["west_path_M", "west_path_X", "west_path_T", "roundabout_W"]
        ),
        "roundabout_W": Object.create(link_state).constructor(
            {lat: 16.996353, lng: -96.752569},
            ["west_path_R", "roundabout_S", "roundabout_N"]
        ),
        "roundabout_N": Object.create(link_state).constructor(
            {lat: 16.996466, lng: -96.752469},
            ["entrance", "roundabout_W", "roundabout_E"]
        ),
        "roundabout_E": Object.create(link_state).constructor(
            {lat: 16.996368, lng: -96.752366},
            ["roundabout_S", "roundabout_N", "chess_board", "A_elbow"]
        ),
        "roundabout_S": Object.create(link_state).constructor(
            {lat: 16.996275, lng: -96.752466},
            ["roundabout_E", "roundabout_W"]
        ),
        "entrance": Object.create(link_state).constructor(
            {lat: 16.996688, lng: -96.752445},
            ["roundabout_N", "A_elbow", "police_booth"]
        ),
        "police_booth": Object.create(link_state).constructor(
            {lat: 16.996799, lng: -96.752452},
            ["entrance"]
        ),
        "chess_board": Object.create(link_state).constructor(
            {lat: 16.996301, lng: -96.752199},
            ["roundabout_E", "A_elbow", "garden"]
        ),
        "A_elbow": Object.create(link_state).constructor(
            {lat: 16.996465, lng: -96.752190},
            ["roundabout_E", "entrance", "chess_board", "A_link", "B_building_north", ]
        ),
        "A_link": Object.create(link_state).constructor(
            {lat: 16.996457, lng: -96.751970},
            ["A_elbow", "A_building", "garden", "B_building_north"]
        ),
        "language_center": Object.create(link_state).constructor(
            {lat: 16.996372, lng: -96.751909},
            ["A_elbow"]
        ),
        "A_building": Object.create(link_state).constructor(
            {lat: 16.996555, lng: -96.751959},
            ["A_link", "gastronomy_school", "turism_school"]
        ),
        "gastronomy_school": Object.create(link_state).constructor(
            {lat: 16.996617, lng: -96.751865},
            ["A_building"]
        ),
        "turism_school": Object.create(link_state).constructor(
            {lat: 16.996613, lng: -96.752245},
            ["A_building"]
        ),
        "B_building_north": Object.create(link_state).constructor(
            {lat: 16.996450, lng: -96.751725},
            ["A_link", "B_building_inside", "B_building_north", "A_elbow", "teachers_parking_lot", "casa"]
        ),
        "teachers_parking_lot": Object.create(link_state).constructor(
            {lat: 16.996468, lng: -96.751562},
            ["B_building_north"]
        ),
        "casa": Object.create(link_state).constructor(
            {lat: 16.996376, lng: -96.751761},
            ["B_building_north"]
        ),
        "B_building_inside": Object.create(link_state).constructor(
            {lat: 16.996321, lng: -96.751705},
            ["B_building_north", "psicologic_orientation_department", "administrative_services", "B_building_south"]
        ),
        "psicologic_orientation_department": Object.create(link_state).constructor(
            {lat: 16.996295, lng: -96.751791},
            ["B_building_inside"]
        ),
        "administrative_services": Object.create(link_state).constructor(
            {lat: 16.996322, lng: -96.751581},
            ["B_building_inside"]
        ),
        "B_building_south": Object.create(link_state).constructor(
            {lat: 16.996221, lng: -96.751707},
            ["cafeteria", "A_Store", "B_building_inside"]
        ),
        "A_Store": Object.create(link_state).constructor(
            {lat: 16.996263, lng: -96.751632},
            ["B_building_south"]
        ),
        "cafeteria": Object.create(link_state).constructor(
            {lat: 16.995996, lng: -96.751693},
            ["B_building_south", "dance_room", "Albet_Einstein_auditorium", "Cuckoo_Coffee", "stationery", "chapel", "music_room"]
        ),
        "Albet_Einstein_auditorium": Object.create(link_state).constructor(
            {lat: 16.996077, lng: -96.751503},
            ["cafeteria"]
        ),
        "Cuckoo_Coffee": Object.create(link_state).constructor(
            {lat: 16.995888, lng: -96.751476},
            ["cafeteria"]
        ),
        "stationery": Object.create(link_state).constructor(
            {lat: 16.995888, lng: -96.751693},
            ["cafeteria", "cafeteria_parking_lot"]
        ),
        "chapel": Object.create(link_state).constructor(
            {lat: 16.995952, lng: -96.751855},
            ["cafeteria", "dance_room"]
        ),
        "music_room": Object.create(link_state).constructor(
            {lat: 16.995952, lng: -96.751931},
            ["cafeteria", "dance_room"]
        ),
        "dance_room": Object.create(link_state).constructor(
            {lat: 16.995956, lng: -96.752017},
            ["cafeteria", "tree_link", "chapel", "music_room", "motorcycle_parking_lot_N"]
        ),
        "tree_link": Object.create(link_state).constructor(
            {lat: 16.996041, lng: -96.752190},
            ["garden", "dance_room", "central_plaza_E"]
        ),
        "garden": Object.create(link_state).constructor(
            {lat: 16.996209, lng: -96.751978},
            ["A_link", "tree_link"]
        ),
        "central_plaza": Object.create(link_state).constructor(
            {lat: 16.995936, lng: -96.752470},
            ["central_plaza_W", "central_plaza_E", "monument"]
        ),
        "central_plaza_W": Object.create(link_state).constructor(
            {lat: 16.996025, lng: -96.752695},
            ["central_plaza", "west_path_M"]
        ),
        "central_plaza_E": Object.create(link_state).constructor(
            {lat: 16.995976, lng: -96.752320},
            ["central_plaza", "tree_link"]
        ),
        "cafeteria_parking_lot": Object.create(link_state).constructor(
            {lat: 16.995662, lng: -96.751802},
            ["stationery", "multisport_field", "motorcycle_parking_lot"]
        ),
        "monument": Object.create(link_state).constructor(
            {lat: 16.995655, lng: -96.752479},
            ["central_plaza", "motorcycle_parking_lot", "sports_elbow"]
        ),
        "motorcycle_parking_lot": Object.create(link_state).constructor(
            {lat: 16.995659, lng: -96.752198},
            ["monument", "cafeteria_parking_lot", "motorcycle_parking_lot_N"]
        ),
        "motorcycle_parking_lot_N": Object.create(link_state).constructor(
            {lat: 16.995659, lng: -96.752198},
            ["motorcycle_parking_lot", "dance_room"]
        ),
        "sports_elbow": Object.create(link_state).constructor(
            {lat: 16.995359, lng: -96.752927},
            ["sports_NE", "monument", "sports_S"]
        ),
        "sports_NE": Object.create(link_state).constructor(
            {lat: 16.994781, lng: -96.752928},
            ["sports_elbow", "sports_S", "sports_NW"]
        ),
        "sports_NW": Object.create(link_state).constructor(
            {lat: 16.994779, lng: -96.753022},
            ["sports_NE", "sports_B", "gym"]
        ), // soccer field
        "sports_S": Object.create(link_state).constructor(
            {lat: 16.994661, lng: -96.752924},
            ["sports_elbow", "soccer_field", "sports_NE", "gym"]
        ), // backstage
        "sports_B": Object.create(link_state).constructor(
            {lat: 16.994783, lng: -96.753206},
            ["fast_soccer_field", "sports_NW"]
        ),
        "multisport_field": Object.create(link_state).constructor(
            {lat: 16.994900, lng: -96.751801},
            ["tenis_field", "cafeteria_parking_lot"]
        ),
        "tenis_field": Object.create(link_state).constructor(
            {lat: 16.994608, lng: -96.751818},
            ["soccer_field", "multisport_field"]
        ),
        "soccer_field": Object.create(link_state).constructor(
            {lat: 16.994593, lng: -96.752483},
            ["tenis_field", "sports_S"]
        ),
        "fast_soccer_field": Object.create(link_state).constructor(
            {lat: 16.995095, lng: -96.753219},
            ["sports_B"]
        ),
        "gym": Object.create(link_state).constructor(
            {lat: 16.994660, lng: -96.753021},
            ["sports_NW", "sports_S", "archery_zone"]
        ),
        "archery_zone": Object.create(link_state).constructor(
            {lat: 16.994592, lng: -96.753026},
            ["gym"]
        )
    };

    /* ------------------------------------------------ */
    /* ------------ find closest node to user --------- */
    /* ------------------------------------------------ */

    function findClosestCoordinates(userCoordinates, mapDatabase) {
        let closestCoordinates = null;
        let minDistance = Number.MAX_VALUE;

        for (const key in mapDatabase) {
            if (mapDatabase.hasOwnProperty(key)) {
                const coordinates = mapDatabase[key].coordinates;
                const distance = calculateDistance(userCoordinates, coordinates);

                if (distance < minDistance) {
                    closestCoordinates = key;
                    minDistance = distance;
                }
            }
        }

        return closestCoordinates;
    }

    
    function calculateDistance(coords1, coords2) {
        const lat1 = coords1.lat;
        const lng1 = coords1.lng;
        const lat2 = coords2.lat;
        const lng2 = coords2.lng;

        const distance = Math.sqrt((lat2 - lat1) ** 2 + (lng2 - lng1) ** 2);

        return distance;
    }

    // get user coordinates and find closest node
    let userCoordinates = { lat: (Math.random() * (16.996627 - 16.994251) + 16.994251), lng: (Math.random() * (-96.751913 - -96.753586) + -96.753586) };;
    let starting_node = findClosestCoordinates(userCoordinates, map_database);



    // start with destination node if user was redirected from info page.
    const this_url = new URLSearchParams(window.location.search);
    const final_node = this_url.get('final_node');
    let destiny_node = final_node || starting_node;

    //console.log("Destiny: " + destiny_node);


    //console.log("Closest Coordinates:", starting_node);

    // predecesor array for disjkstra route
    let predecessor;

    function dijkstra(startingNode) {
        let visited = {};
        predecessor = {};
        let distance = {};

        for (const key in map_database) {
            visited[key] = false;
            predecessor[key] = null;
            distance[key] = Infinity;
        }
        distance[startingNode] = 0;
        
        let queue = [];
        queue.push({ node: startingNode, cost: 0 });

        while (queue.length > 0) {
            queue.sort((a, b) => a.cost - b.cost);
            const { node, cost } = queue.shift();

            //console.log("iteration node: ", node);

            if (visited[node]) continue;

            visited[node] = true;

            //console.log("Cheking node connections");
            for (const neighbor of map_database[node].neighbors) {
                const newDistance = distance[node] + 1;
                if (newDistance < distance[neighbor]) {
                    distance[neighbor] = newDistance;
                    predecessor[neighbor] = node;
                    queue.push({ node: neighbor, cost: newDistance });
                    //console.log("adding path to: ", neighbor);
                }
            }
        }
    }

    function printRoute(node) {

        userCoordinates = { lat: (Math.random() * (16.996627 - 16.994251) + 16.994251), lng: (Math.random() * (-96.751913 - -96.753586) + -96.753586) };

        starting_node = findClosestCoordinates(userCoordinates, map_database);

        dijkstra(starting_node);

        let route = []; // stack used to inverse route order in case needed

        while (predecessor[node] != null) {
            route.push(map_database[node].coordinates);
            //console.log("Next Hop: ", node);
            node = predecessor[node];
        }
        route.push(map_database[starting_node].coordinates);
        //console.log("Next Hop: ", node);
        
        return route;
    }

    /* ------------------------------------------------- */
    /* ------------------ map creation ----------------- */
    /* ------------------------------------------------- */

    function iniciarMap(){
        var zonaDelimitada = {
            north: 16.996910783051042, // Límite norte
            south: 16.9940741352538, // Límite sur
            east: -96.75117488200935, // Límite este
            west: -96.75433787680308  // Límite oeste
        };

        var coord = {lat:16.9956106 ,lng: -96.7527389};
        var coordCafeteria = {lat: 16.995888, lng: -96.751476};
        var coordCB = {lat: 16.996440630852607, lng: -96.75343632121756};
        var coordajedrez = {lat: 16.99604693405557, lng: -96.7520685290419}
        var coordIngenieria = {lat: 16.996577, lng: -96.753338};
        var coordGym = {lat: 16.994731, lng: -96.753082};
        var coordMed = {lat: 16.995969, lng: -96.753193};
        var coordEst = {lat: 16.99522687664391, lng: -96.7515722692146};
        var coordEst2 = {lat: 16.996594866043072, lng: -96.7514552321965};
        var coordEst3 = {lat: 16.99677869084291, lng: -96.75321143006741};
        var coordgasrto = {lat:16.99660532350971, lng:-96.75214547917045};
        var coordBasquet = {lat: 16.994806, lng: -96.751965};
        var coordFutbol = {lat: 16.99461, lng: -96.75249};
        var coordBiblioteca = {lat: 16.99628, lng: -96.75340};
        var coordA = {lat: 16.99659, lng:-96.75199006422191};
        var coordB = {lat: 16.99629322285019, lng: -96.75175201817626};
        var coordC = {lat: 16.996298341782893, lng: -96.75320091553742};
        var coordD = {lat: 16.99603093409722, lng: -96.75322036154847};
        var coordE = { lat: 16.99655805391819, lng: -96.75318884559634}

        var map = new google.maps.Map(document.getElementById('map'),{
            zoom: 20,
            center: coord,
            draggable: true, //desplazar en el mapa
            minZoom: 20,
            streetViewControl: false, //Quitar muñequito de google
            fullscreenControl: false, //quitar la opcion de pantalla completa
            mapTypeControl: true, //quitar la opcion de satelite
            mapTypeControlOptions: {
                style: google.maps.MapTypeControlStyle.DROPDOWN_MENU,
                position: google.maps.ControlPosition.TOP_LEFT,
                zoomControl: true,
                zoomControlOptions: {
                    position: google.maps.ControlPosition.RIGHT_BOTTOM
                }
            },
            restriction: {
                latLngBounds: zonaDelimitada,
                strictBounds: false
            },
            styles: [{ featureType: "poi", elementType: "labels", stylers: [{ visibility: "off" }]}] //Quitar los marcadores de google
        });


        /* --------------------------------------------- */
        /* ----------------- pop-up icons -------------- */
        /* --------------------------------------------- */
        
        var iconoajedrez = {
            url: 'Ajedrez.png',
            scaledSize: new google.maps.Size(50, 50)
        };
        var markerajedrez = new google.maps.Marker({
            position: coordajedrez,
            map: map,
            icon: iconoajedrez
        });
        var infoWindow = new google.maps.InfoWindow({
            content: "This is the pop-up window content." // Replace with your desired content
        });
        // Add a click event listener to the marker
        markerajedrez.addListener("click", function() {
            infoWindow.open(map, markerajedrez); // Open the info window when marker is clicked
        });

        //Edifico A
        var iconoA = {
            url: 'A.png',
            scaledSize: new google.maps.Size(50, 50)
        };
        var markerA = new google.maps.Marker({
            position: coordA,
            map: map,
            icon: iconoA
        });
        var infoWindowA = new google.maps.InfoWindow({
        content: "Edificio A-Edith Stein: <br> Salones de uso comun: Piso 1 y 2 <br> Gastronomia: Piso 3"
        });
        // Add a click event listener to the marker
        markerA.addListener("click", function() {
            infoWindowA.open(map, markerA); // Open the info window when marker is clicked
        });

        var iconoB = {
            url: 'B.png',
            scaledSize: new google.maps.Size(50, 50)
        };
        var markerB  =new google.maps.Marker({
            position: coordB,
            map: map,
            icon: iconoB
        });
        var infoWindowB = new google.maps.InfoWindow({
            content: "Edificio B: <br> Oficinas centrales"
        });
        // Add a click event listener to the marker
        markerB.addListener("click", function() {
            infoWindowB.open(map, markerB); // Open the info window when marker is clicked
        });

        //Edifico C
        var iconoC = {
            url: 'C.png',
            scaledSize: new google.maps.Size(50, 50)
        };
        var markerC = new google.maps.Marker({
            position: coordC,
            map: map,
            icon: iconoC
        });
        var infoWindowC = new google.maps.InfoWindow({
            content: "Edificio C-Antonio Caso <br> Biblioteca: Piso 1 <br> Salones de uso comun: Piso 2"
        });
        // Add a click event listener to the marker
        markerC.addListener("click", function() {
            infoWindowC.open(map, markerC); // Open the info window when marker is clicked
        });

        //Edificio D
        var iconoD = {
            url: 'D.png',
            scaledSize: new google.maps.Size(50, 50)
        };
        var markerD = new google.maps.Marker({
            position: coordD,
            map: map,
            icon: iconoD
        });
        var infoWindowD = new google.maps.InfoWindow({
            content: "Edificio D-Jerome Lejeune: <br> Medicina: Piso 1 <br> Slones de uso comun: Piso 2"
        });
        // Add a click event listener to the marker
        markerD.addListener("click", function() {
            infoWindowD.open(map, markerD); // Open the info window when marker is clicked
        });

        //Edificio E
        var iconoE = {
            url: 'E.png',
            scaledSize: new google.maps.Size(50, 50)
        };
        var markerE = new google.maps.Marker({
            position: coordE,
            map: map,
            icon: iconoE
        });
        var infoWindowE = new google.maps.InfoWindow({
            content: "Edificio E-Anne Sullivan <br> Ingenieria y Comunicacion: Piso 1 <br> Diseño y Oficinas: Piso 2"
        });
        markerE.addListener("click", function() {
            infoWindowE.open(map, markerE); // Open the info window when marker is clicked
        });

        var iconoCafeteria = {
            url: 'logo2.png',
            scaledSize: new google.maps.Size(50, 50)
        };

        var markerCafeteria = new google.maps.Marker({
            position: coordCafeteria,
            map: map,
            icon: iconoCafeteria
        });
        var infoWindowCafeteria = new google.maps.InfoWindow({
            content: "Cuckoo <br> Horario: <br> Lun-Vie 8:00-19:00. <br> Sab 8:00-13:30 <br> 4,9 ⭐⭐⭐⭐⭐"
        });
        // Add a click event listener to the marker
        markerCafeteria.addListener("click", function() {
            infoWindowCafeteria.open(map, markerCafeteria); // Open the info window when marker is clicked
        });

        var iconoEstacionamiento = {
            url: 'logoEst.png',
            scaledSize: new google.maps.Size(50, 50)
        };
        var markerEstacionamiento = new google.maps.Marker({
            position: coordEst,
            map: map,
            icon: iconoEstacionamiento
        });
        var infoWindow = new google.maps.InfoWindow({
            content: "This is the pop-up window content." // Replace with your desired content
        });
        // Add a click event listener to the marker
        markerEstacionamiento.addListener("click", function() {
            infoWindow.open(map, markerEstacionamiento); // Open the info window when marker is clicked
        });

        //estacionamiento 2
        var iconoEstacionamiento2 = {
            url: 'logoEst.png',
            scaledSize: new google.maps.Size(50, 50)
        };
        var markerEstacionamiento2 = new google.maps.Marker({
            position: coordEst2,
            map: map,
            icon: iconoEstacionamiento
        });
        var infoWindow = new google.maps.InfoWindow({
            content: "This is the pop-up window content." // Replace with your desired content
        });
        // Add a click event listener to the marker
        markerEstacionamiento2.addListener("click", function() {
            infoWindow.open(map, markerEstacionamiento2); // Open the info window when marker is clicked
        });

        //Estacionamiento 3
        var iconoEstacionamiento3 = {
            url: 'logoEst.png',
            scaledSize: new google.maps.Size(50, 50)
        };
        var markerEstacionamiento3 = new google.maps.Marker({
            position: coordEst3,
            map: map,
            icon: iconoEstacionamiento3
        });
        var infoWindow = new google.maps.InfoWindow({
            content: "This is the pop-up window content." // Replace with your desired content
        });
        // Add a click event listener to the marker
        markerEstacionamiento3.addListener("click", function() {
            infoWindow.open(map, markerEstacionamiento3); // Open the info window when marker is clicked
        });


        var iconoIngenieria = {
            url: 'logoInge.png',
            scaledSize: new google.maps.Size(50, 50)
        };

        var markerIngenieria = new google.maps.Marker({
            position: coordIngenieria,
            map: map,
            icon: iconoIngenieria
        });
        var infoWindow = new google.maps.InfoWindow({
            content: "This is the pop-up window content." // Replace with your desired content
        });
        // Add a click event listener to the marker
        markerIngenieria.addListener("click", function() {
            infoWindow.open(map, markerIngenieria); // Open the info window when marker is clicked
        });


        var iconoBasquet = {
            url: 'logoBasq.png',
            scaledSize: new google.maps.Size(50, 50)
        };
        var markerBasquet = new google.maps.Marker({
            position: coordBasquet,
            map: map,
            icon: iconoBasquet
        });
        var infoWindowBasquet = new google.maps.InfoWindow({
            content: "Canchas de Basquetbol" // Replace with your desired content
        });
        // Add a click event listener to the marker
        markerBasquet.addListener("click", function() {
            infoWindowBasquet.open(map, markerBasquet); // Open the info window when marker is clicked
        });

        var iconoFutbol = {
            url: 'futbolLogo.png',
            scaledSize: new google.maps.Size(50, 50)
        };
        var markerFutbol = new google.maps.Marker({
            position: coordFutbol,
            map: map,
            icon: iconoFutbol
        });
        var infoWindowFutbol = new google.maps.InfoWindow({
            content: "Cancha de futbol 11" // Replace with your desired content
        });
        // Add a click event listener to the marker
        markerFutbol.addListener("click", function() {
            infoWindowFutbol.open(map, markerFutbol); // Open the info window when marker is clicked
        });

        var iconoGym = {
            url: 'logoGym.png',
            scaledSize: new google.maps.Size(50, 50)
        };

        var markerGym = new google.maps.Marker({
            position: coordGym,
            map: map,
            icon: iconoGym
        });
        var infoWindow = new google.maps.InfoWindow({
            content: "This is the pop-up window content." // Replace with your desired content
        });

        // Add a click event listener to the marker
        markerGym.addListener("click", function() {
            infoWindow.open(map, markerGym); // Open the info window when marker is clicked
        });

        var iconoArchery = {
            url: 'Archery2.png',
            scaledSize: new google.maps.Size(30, 30)
        };

        var markerArchery = new google.maps.Marker({
            position: coordGym,
            map: map,
            icon: iconoArchery
        });
        var infoWindow = new google.maps.InfoWindow({
            content: "This is the pop-up window content." // Replace with your desired content
        });

        // Add a click event listener to the marker
        markerArchery.addListener("click", function() {
            infoWindow.open(map, markerArchery); // Open the info window when marker is clicked
        });

        var iconoCB = {
            url: 'logo2.png',
            scaledSize: new google.maps.Size(25, 25)
        };
        var markerCB = new google.maps.Marker({
            position: coordCB,
            map: map,
            icon: iconoCB
        });
        var infoWindow = new google.maps.InfoWindow({
            content: "This is the pop-up window content." // Replace with your desired content
        });
        // Add a click event listener to the marker
        markerCB.addListener("click", function() {
            infoWindow.open(map, markerCB); // Open the info window when marker is clicked
        });

        var iconoIngenieria = {
            url: 'logoInge.png',
            originalSize: new google.maps.Size(50, 50),
            scaledSize: new google.maps.Size(30, 30),
        };

        var markerIngenieria = new google.maps.Marker({
            position: coordIngenieria,
            map: map,
            icon: iconoIngenieria
        });

        var infoWindow = new google.maps.InfoWindow({
            content: "This is the pop-up window content." // Replace with your desired content
        });

        // Add a click event listener to the marker
        markerIngenieria.addListener("click", function() {
            infoWindow.open(map, markerIngenieria); // Open the info window when marker is clicked
        });

        var iconoBiblioteca = {
            url: 'logoBiblio.png',
            scaledSize: new google.maps.Size(50, 50)
        };
        var markerBiblioteca = new google.maps.Marker({
            position: coordBiblioteca,
            map: map,
            icon: iconoBiblioteca
        });
        var infoWindowBiblioteca = new google.maps.InfoWindow({
            content: "Biblioteca <br> Para mas informacion comunicate con: <br> Coordinador de Biblioteca: julio.mendoza@anahuac.mx <br> Asistente de Biblioteca: agripino.garcia@anahuac.mx" // Replace with your desired content
        });
        // Add a click event listener to the marker
        markerBiblioteca.addListener("click", function() {
            infoWindowBiblioteca.open(map, markerBiblioteca); // Open the info window when marker is clicked
        });

        var iconoMedicina = {
            url: 'logoMedicina.png',
            scaledSize: new google.maps.Size(50, 50)
        };

        var markerMedicina = new google.maps.Marker({
            position: coordMed,
            map: map,
            icon: iconoMedicina
        });
        var infoWindow = new google.maps.InfoWindow({
            content: "This is the pop-up window content." // Replace with your desired content
        });

        // Add a click event listener to the marker
        markerMedicina.addListener("click", function() {
            infoWindow.open(map, markerMedicina); // Open the info window when marker is clicked
        });

        var iconogastro = {
            url: 'gastro2.png',
            scaledSize: new google.maps.Size(30, 30)
        };
        var markergastro = new google.maps.Marker({
            position: coordgasrto,
            map: map,
            icon: iconogastro
        });
        var infoWindow = new google.maps.InfoWindow({
            content: "This is the pop-up window content." // Replace with your desired content
        });
        // Add a click event listener to the marker
        markergastro.addListener("click", function() {
            infoWindow.open(map, markergastro); // Open the info window when marker is clicked
        });

        var markerCafeteria = new google.maps.Marker({
            position: coordCafeteria,
            map: map,
            icon: iconoCafeteria
        });

        var infoWindowCafeteria = new google.maps.InfoWindow({
            content: "Cuckoo <br> Horario: <br> Lun-Vie 8:00-19:00. <br> Sab 8:00-13:30 <br> 4,9 ⭐⭐⭐⭐⭐"
        });

        markerCafeteria.addListener("click", function() {
            infoWindowCafeteria.open(map, markerCafeteria); // Open the info window when marker is clicked
            updateRoute("Cuckoo_Coffee");
        });

        
        


        var iconoParaDirecciones = {
            url: 'imagenDirecciones.png',
            scaledSize: new google.maps.Size(30, 30)
        };

        const coordMarkerDirectionCafeteria = {lat: 16.995948, lng: -96.751616};
        const coordMarkerDirectionMedicina = {lat: 16.996083, lng: -96.753053};
        const coordMarkerDirectionIngenieria = {lat: 16.996573, lng: -96.752999};
        const coordMarkerDirectionBiblioteca = {lat: 16.99627417387208, lng: -96.75310644421046};
        const coordMarkerDirectionEdificioA = {lat: 16.996600, lng: -96.752089};
        const coordMarkerDirectionEdificioB = {lat: 16.996293, lng: -96.751893};
        const coordMarkerDirectionBasquet = {lat: 16.994652, lng: -96.751874};
        const coordMarkerDirectionGym = {lat: 16.994524, lng: -96.753017};
        const coordMarkerDirectionFut = {lat: 16.995096, lng: -96.752501};

        var markerDirectionCafeteria = new google.maps.Marker({
            position: coordMarkerDirectionCafeteria,
            map: map,
            icon: iconoParaDirecciones
        });

        var markerDirectionMedicina = new google.maps.Marker({
            position: coordMarkerDirectionMedicina,
            map: map,
            icon: iconoParaDirecciones
        });

        var markerDirectionIngenieria = new google.maps.Marker({
            position: coordMarkerDirectionIngenieria,
            map: map,
            icon: iconoParaDirecciones
        });

        var markerDirectionBiblioteca = new google.maps.Marker({
            position: coordMarkerDirectionBiblioteca,
            map: map,
            icon: iconoParaDirecciones
        });

        var markerDirectionEdificioA = new google.maps.Marker({
            position: coordMarkerDirectionEdificioA,
            map: map,
            icon: iconoParaDirecciones
        });

        var markerDirectionEdificioB = new google.maps.Marker({
            position: coordMarkerDirectionEdificioB,
            map: map,
            icon: iconoParaDirecciones
        });

        var markerDirectionBasquet = new google.maps.Marker({
            position: coordMarkerDirectionBasquet,
            map: map,
            icon: iconoParaDirecciones
        });

        var markerDirectionGym = new google.maps.Marker({
            position: coordMarkerDirectionGym,
            map: map,
            icon: iconoParaDirecciones
        });

        var markerDirectionFut = new google.maps.Marker({
            position: coordMarkerDirectionFut,
            map: map,
            icon: iconoParaDirecciones
        });

        markerDirectionCafeteria.addListener('click', function() {
            updateRoute("Cuckoo_Coffee", function() {
                //starting_node = "Cuckoo_Coffee";
            });
        });

        markerDirectionMedicina.addListener('click', function() {
            updateRoute("medicine_school", function() {
                //starting_node = "medicine_school";
            });
        });


        markerDirectionIngenieria.addListener('click', function() {
            updateRoute("engineering_school", function() {
                //starting_node = "engineering_school";
            });
        });

        markerDirectionBiblioteca.addListener('click', function() {
            updateRoute("library", function() {
                //starting_node = "library";
            });
        });

        markerDirectionEdificioA.addListener('click', function() {
            updateRoute("A_building", function() {
                //starting_node = "A_building";
            });
        });

        markerDirectionEdificioB.addListener('click', function() {
            updateRoute("B_building_inside", function() {
                //starting_node = "B_building_inside";
            });
        });

        markerDirectionBasquet.addListener('click', function() {
            updateRoute("multisport_field", function() {
                //starting_node = "multisport_field";
            });
        });

        markerDirectionGym.addListener('click', function() {
            updateRoute("gym", function() {
                //starting_node = "gym";
            });
        });

        markerDirectionFut.addListener('click', function() {
            updateRoute("soccer_field", function() {
                //starting_node = "soccer_field";
            });
        });


        var zonaUniversidadCoords = [
            {lat:16.996972,lng:-96.754344},
            {lat:16.994056,lng:-96.754328},
            {lat:16.994068,lng:-96.751822},
            {lat:16.994366,lng:-96.751643},
            {lat:16.994813,lng:-96.751289},
            {lat:16.994885,lng:-96.751265},
            {lat:16.994931,lng:-96.751254},
            {lat:16.995035,lng:-96.751238},
            {lat:16.996497,lng:-96.751119},
            {lat:16.996558,lng:-96.751119},
            {lat:16.996627,lng:-96.751139},
            {lat:16.996821,lng:-96.751268},
            {lat:16.996853,lng:-96.751283},
            {lat:16.996873,lng:-96.751297},
            {lat:16.996899,lng:-96.752458},
        ];

        /* --------------------------------------------- */
        /* ---------- path finding algorithm ----------- */
        /* --------------------------------------------- */

        /* ------------ enable trace route ------------- */

        // Create a DirectionsService instance
        directionsService = new google.maps.DirectionsService();

        // array that stores the path without starting and final nodes
        let inner_path = printRoute();

        inner_path.pop();
        inner_path.shift();

        // Define the directions request
        let request = {
            origin: userCoordinates,
            destination: map_database[destiny_node].coordinates,
            waypoints: inner_path,
            travelMode: google.maps.TravelMode.WALKING,
        };

        // Make the directions request
        directionsService.route(request, function (response, status) {
            if (status === google.maps.DirectionsStatus.OK) {
                // Display the directions on the map
                directionsRenderer = new google.maps.DirectionsRenderer();
                directionsRenderer.setMap(map);
                directionsRenderer.setDirections(response);

                // Create a Polyline for the custom route
                let waypoints = printRoute(destiny_node);

                polyline = new google.maps.Polyline({
                    path: waypoints,
                    geodesic: true,
                    strokeColor: "#FF0000",
                    strokeOpacity: 1.0,
                    strokeWeight: 2,
                });

                polyline.setMap(map);
            }
        });

        
        /* --------------------------------------------- */
        /* --- update route when user press a button --- */
        /* --------------------------------------------- */

        // Define global variables to store references to DirectionsRenderer and Polyline
        

        function updateRoute(destiny_node, callback) {
            // Create a new DirectionsService instance
            directionsService = new google.maps.DirectionsService();

            // Remove previous path from the map if it exists
            if (directionsRenderer) {
                directionsRenderer.setMap(null);
            }
            if (polyline) {
                polyline.setMap(null);
            }

            // Define the directions request with the updated destination
            let request = {
                origin: map_database[starting_node].coordinates,
                destination: map_database[destiny_node].coordinates,
                waypoints: inner_path,
                travelMode: google.maps.TravelMode.WALKING,
            };

            // Make the directions request
            directionsService.route(request, function (response, status) {
                if (status === google.maps.DirectionsStatus.OK) {
                    // Display the directions on the map
                    directionsRenderer = new google.maps.DirectionsRenderer();
                    directionsRenderer.setMap(map);
                    directionsRenderer.setDirections(response);

                    // Create a Polyline for the custom route
                    let waypoints = printRoute(destiny_node);

                    polyline = new google.maps.Polyline({
                        path: waypoints,
                        geodesic: true,
                        strokeColor: "#FF0000",
                        strokeOpacity: 1.0,
                        strokeWeight: 2,
                    });

                    polyline.setMap(map);

                    // Call the callback function to indicate that updateRoute has completed
                    if (typeof callback === 'function') {
                        callback();
                    }
                }
            });
        }


        /* -------------------------------------------- */
        /* ------------ user geolocalization ---------- */
        /* -------------------------------------------- */
        
        // Crear el marcador de la ubicación del usuario
        var marker = new google.maps.Marker({
            map: map,
            icon: {
                path: google.maps.SymbolPath.CIRCLE,
                scale: 10,
                fillColor: '#039be5',
                fillOpacity: 1,
                strokeColor: '#039be5',
                strokeOpacity: 1,
                strokeWeight: 1,
            },
            zIndex: 1000
        });

        // Obtener la ubicación del usuario en tiempo real
        if (navigator.geolocation) {
            navigator.geolocation.watchPosition(function(position) {
                var pos = {
                    lat: position.coords.latitude,
                    lng: position.coords.longitude

                };              
                // Centrar el mapa en la ubicación del usuario
                map.setCenter(pos);
                // Actualizar la posición del marcador
                marker.setPosition(pos);
                //Cafetería
                if(pos.lat >= 16.995900 && pos.lat <=16.996000 && pos.lng >= -96.75158 && pos.lng <= -96.75140){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/23/p/23" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //pasillo cafeteria
                if(pos.lat >= 16.996101 && pos.lat <=16.996247 && pos.lng >= -96.751768 && pos.lng <= -96.751664){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/9/p/9" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //edificio B
                if(pos.lat >= 16.996286 && pos.lat <=16.996432 && pos.lng >= -96.751817 && pos.lng <= -96.751639){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/8/p/8" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //afuera Cafeteria
                if(pos.lat >= 16.995930 && pos.lat <=16.996036 && pos.lng >= -96.751784 && pos.lng <= -96.751626){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/10/p/10" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //Pasillo Edf A-B
                if(pos.lat >= 16.996441 && pos.lat <=16.996556 && pos.lng >= -96.751862 && pos.lng <= -96.751600){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/7/p/7" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //Enfrente Edf A
                if(pos.lat >= 16.996441 && pos.lat <=16.996556 && pos.lng >= -96.752113 && pos.lng <= -96.751920){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/5/p/5" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //ajedrez
                if(pos.lat >= 16.996274 && pos.lat <=16.996411 && pos.lng >= -96.752333 && pos.lng <= -96.752202){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/4/p/4" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //fuente
                if(pos.lat >= 16.996227 && pos.lat <=16.996469 && pos.lng >= -96.752570 && pos.lng <= -96.752361){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/0/p/3" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //Pasillo-1 Edf E
                if(pos.lat >= 16.996438 && pos.lat <=16.996543 && pos.lng >= -96.753078 && pos.lng <= -96.752868){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/2/p/0" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //Pasillo-2 Edf E
                if(pos.lat >= 16.996438 && pos.lat <=16.996543 && pos.lng >= -96.753349 && pos.lng <= -96.753192){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/19/p/19" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //Cucko Box
                if(pos.lat >= 16.996438 && pos.lat <=16.996543 && pos.lng >= -96.753526 && pos.lng <= -96.753416){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/18/p/18" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //pasillo-1 Edf C
                if(pos.lat >= 16.996267427747682 && pos.lat <=16.996380290365558 && pos.lng >=  -96.75300958284186 && pos.lng <= -96.75295593865954){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/21/p/21" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //fuente izq
                if(pos.lat >= 16.996267427747682 && pos.lat <=16.996441851764857 && pos.lng >= -96.75277623064876 && pos.lng <= -96.75262870914737){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/1/p/1" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //Edf C
                if(pos.lat >= 16.9961699554321 && pos.lat <=16.99624947232493 && pos.lng >= -96.75310346016092 && pos.lng <= -96.75300421842361){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/15/p/15" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //fuente izq 2
                if(pos.lat >= 16.9961699554321 && pos.lat <=16.99624947232493 && pos.lng >= -96.7529157055228 && pos.lng <= -96.75280573494904){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/3/p/2" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //Pasillo Edf C-D
                if(pos.lat >= 16.996139 && pos.lat <=16.996251 && pos.lng >= -96.753263 && pos.lng <= -96.753132){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/16/p/16" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //ingeniería
                if(pos.lat >= 16.996575 && pos.lat <=16.996664 && pos.lng >= -96.753416 && pos.lng <= -96.753282){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/44/p/44" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //ingeniería2
                if(pos.lat >= 16.996575 && pos.lat <=16.996664 && pos.lng >= -96.753258 && pos.lng <= -96.753176){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/20/p/20" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //Estacionamiento Ing-1
                if(pos.lat >= 16.996717 && pos.lat <=16.996857 && pos.lng >= -96.753294 && pos.lng <= -96.753154){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/39/p/39" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //Estacionamiento Ing-2
                if(pos.lat >= 16.996717 && pos.lat <=16.996857 && pos.lng >= -96.753541 && pos.lng <= -96.753388){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/40/p/40" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //plazaC-1
                if(pos.lat >= 16.99590062376828 && pos.lat <=16.99599296609593 && pos.lng >= -96.75258847602973 && pos.lng <= -96.75234975941841){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/13/p/13" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //pastoral
                if(pos.lat >= 16.995910884024333 && pos.lat <=16.996010921538428 && pos.lng >= -96.75204398759873 && pos.lng <= -96.75186964400618){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/11/p/11" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //placaC-2
                if(pos.lat >= 16.9955125345236 && pos.lat <=16.995663873627862 && pos.lng >= -96.75263151526336 && pos.lng <= -96.75234720109705){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/28/p/28" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //gym
                if(pos.lat >= 16.994612192567782 && pos.lat <=16.994830224489085 && pos.lng >= -96.75303116440573 && pos.lng <= -96.75287827848612){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/32/p/32" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //gym-2
                if(pos.lat >= 16.994696840284995 && pos.lat <=16.994817399088966 && pos.lng >= -96.75326183438972 && pos.lng <= -96.75310358405189){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/33/p/33" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //gym-3
                if(pos.lat >= 16.99489435148077 && pos.lat <=16.995197030565247 && pos.lng >= -96.75298020243359 && pos.lng <= -96.75288900732365){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/31/p/31" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
                //arbol
                if(pos.lat >= 16.99599032326787 && pos.lat <=16.996098055927487 && pos.lng >= -96.75227083041062 && pos.lng <= -96.75212062670013){
                    var tour3d = document.getElementById("tourd");
                    tour3d.innerHTML = `
                    <iframe src="http://www.vtility.net/virtualtour/6xNNID78A4#!s/12/p/12" allowfullscreen="True" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                `
                }
            }, function() {
                // Error al obtener la ubicación del usuario
                handleLocationError(true, marker, map.getCenter());
            });
        } else {
            // El navegador no soporta geolocalización
            handleLocationError(false, marker, map.getCenter());
        }




    }

    function handleLocationError(browserHasGeolocation, marker, pos) {
        // Mostrar un mensaje de error si no se puede obtener la ubicación del usuario
        var infoWindow = new google.maps.InfoWindow({map: map});
        infoWindow.setPosition(pos);
        infoWindow.setContent(browserHasGeolocation ?
            'Error: No se pudo obtener tu ubicación' :
            'Error: Tu navegador no soporta geolocalización');
    }

</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCGn7mLYMk_m978YH-QjDc_pb9JCWTaWH4&callback=iniciarMap"></script>
</body>
</html>
